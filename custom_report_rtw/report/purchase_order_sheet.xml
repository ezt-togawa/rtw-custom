<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_purchase_order_pdf_list_form">
    <t t-call="web.html_container">
      <t t-foreach="docs[0]" t-as="o">
        <t t-call="custom_report_rtw.so_ex_layout">
          <t t-set="total_subprice" t-value="0" />
          <t t-set="total_listprice" t-value="0" />
          <t t-if="not o" t-set="o" t-value="doc" />
          <t t-if="not company">
            <!-- Multicompany -->
            <t t-if="company_id">
              <t t-set="company" t-value="company_id" />
            </t>
            <t t-elif="o and 'company_id' in o and o.company_id.sudo()">
              <t t-set="company" t-value="o.company_id.sudo()" />
            </t>
            <t t-else="else">
              <t t-set="company" t-value="res_company" />
            </t>
          </t>
          <t t-call="custom_report_rtw.SO_purchase_order_sheet_header_layout"></t>
          <div class="page">
            <t t-foreach="o.mrp_production_so_id" t-as="so">
              <t
                t-set="type">quotation</t>
              <t t-set="address">
                <div t-field="so.partner_id"
                  t-options='{"widget": "contact", "fields": ["address", "name"],
                        "no_marker": True}' />
                <p t-if="so.partner_id.vat"><t
                    t-esc="so.company_id.country_id.vat_label or 'Tax ID'" />: <span
                    t-field="so.partner_id.vat" />
                </p>
              </t>
              <div t-if="so.company_id.logo or so.company_id.report_header"
                class="row zero_min_height">
              </div>
              <div class="row size13" style="margin-top:-30px;">
                <div class="col-4">
                  <t t-if="o.lang_code == 'en_US'">
                    <div class="size16">御中 <span
                        t-field="o.picking_type_id.warehouse_id.partner_id.name" /></div>
                  </t>
                  <t t-else="">
                    <div class="size16"><span
                        t-field="o.picking_type_id.warehouse_id.partner_id.name" /> 御中</div>
                  </t>
                  <div> 発注番号 <span class="size16"
                      t-field="so.name" />
                  </div>
                  <br />
                  <div> 配達希望日 <t>
                      <t t-if="o.mrp_production_parent_id">
                        <span class="size14"
                          t-field="o.mrp_production_parent_id.mrp_production_date_planned_start" />
                      </t>
                      <t t-else="">
                        <!-- <t t-if="so.sipping_to == 'direct'">
                          <span class="size14" t-field="so.sale_order_preferred_delivery_date" />
                        </t>
                        <t t-else="">
                          <span class="size14" t-field="so.warehouse_arrive_date" />
                        </t> -->
                        <span class="size14" t-field="o.mrp_child_mo_desired_delivery_date" />
                      </t>
                    </t>
                  </div>
                  <br />
                  <div class="d-flex">
                    <div>
                      物件名:
                    </div>
                    <div>
                      <div class="size16">
                        <p style="line-height:16px; margin:0;" t-field="so.title" />
                      </div>
                      <div class="size13">
                        <span t-field="so.partner_id.name" />
                      <span
                          t-field="so.partner_id.site" />
                      <span t-field="so.partner_id.department" />
                      <span
                          t-field="so.partner_id.user_id.name" /> ご依頼分 </div>
                    </div>
                  </div>
                </div>
                <div class="col-4">
                </div>
                <div class="col-4 size11" name="company_address">
                  <div class="float-right">
                    <div class="d-flex">
                      <div>
                        <span t-if="so.overseas" class="size18 pt-2 pr-1">(海外)</span>
                      </div>
                      <div>
                        <div>
                          <img style="width:180px;height:40px;"
                            src="/custom_report_rtw/static/src/images/company_logo2.jpeg"
                            alt="Logo" />
                        </div>
                        <div>
                          <div class="size12">
                            <span t-esc="o.hr_employee_company" />
                          </div>
                          <div>
                            <span t-esc="o.hr_employee_department" />
                          </div>
                          <div>
                            <span t-esc="o.hr_employee_zip" />
                          </div>
                          <div>
                            <span t-esc="o.hr_employee_info" />
                          </div>
                          <div>
                            <span t-esc="o.hr_employee_tel" />
                          </div>
                          <div>
                            <span t-esc="o.hr_employee_fax" />
                          </div>
                          <div class="size12">
                            <span t-esc="o.hr_employee_printer" />
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row py-2">
                <div class="col-4 size14">
                  <t t-if="so.sipping_to =='direct'">
                    <div> 送り先: <span t-field="so.shipping_destination_text" /></div>
                  </t>
                  <t t-elif="o.address_ship and o.address_ship == 'デポ/直送'">
                    <div> 送り先: <span t-field="so.sale_order_waypoint_name" /></div>
                    <div> 住所: <span t-field="so.sale_order_waypoint_address" /></div>
                    <div> TEL: <span t-if="so.waypoint.phone" t-field="so.waypoint.phone" /></div>
                  </t>
                  <t t-else="">
                    <div> 送り先: <span t-field="o.mrp_choose_option_find_warehouse_company_name" /></div>
                    <div> 住所: <span t-field="o.mrp_choose_option_find_warehouse_address" /></div>
                    <div> TEL: <span t-field="o.mrp_choose_option_find_warehouse_phone" /></div>
                  </t>
                </div>
                <div class="col-4 size13">
                  <div style="padding-left:60px;">
                    <div> 送り先注記: <span t-field="so.remark" />
                      <br />
                      <!-- <span t-field="docs.production_memo" /> -->
                    </div>
                  </div>
                </div>
                <div class="col-4">
                </div>
              </div>
              <table
                class="table">
                <t t-groupby="10" t-att-last="last">
                  <thead>
                    <tr class="table-title bold" style="font-size:13px;background-color:#999999">
                      <th class="text-center" style="width:1%">№</th>
                      <th class="text-center" style="width:10%">品名</th>
                      <th class="text-center" style="width:20%">仕様・詳細１</th>
                      <th class="text-center" style="width:20%">仕様・詳細２</th>
                      <th class="text-center" style="width:7%">数量</th>
                      <th class="text-center" style="width:5%"></th>
                      <th class="text-center" style="width:7%">取説</th>
                      <th class="text-center" style="width:15%">Custom</th>
                      <th class="text-center" style="width:15%">メモ</th>
                    </tr>
                  </thead>

                  <tbody class="invoice_tbody">
                    <t t-set="index" t-value="0" />
                    <t t-foreach="docs" t-as="line">
                      <t t-set="index" t-value="index+1" />
                      <tr class="size15 table-border-bottom">
                        <td class="text-center size12">
                          <span t-esc="index" />
                        </td>
                        <td class="size12">
                          <div class="six-lines">
                            <div t-if="line.mrp_product_name" t-field="line.mrp_product_name" />
                            <div t-if="line.product_id.summary" t-field="line.product_id.summary" />
                            <div t-if="line.mrp_product_type" t-field="line.mrp_product_type" />
                            <t t-if="line.mrp_production_order_line">
                              <span
                                t-field="line.mrp_production_order_line.product_size" />
                            </t>
                          </div>
                        </td>
                        <td class="size12">
                          <div class="six-lines">
                            <t
                              t-foreach="line.product_id.product_template_attribute_value_ids[0:6]"
                              t-as="string_line">
                              <div class="one-lines"> ● <span
                                  t-esc="string_line.display_name" />
                                                    <br />
                              </div>
                            </t>
                          </div>
                        </td>
                        <td class="size12">
                          <div class="six-lines">
                            <t
                              t-foreach="line.product_id.product_template_attribute_value_ids[6:12]"
                              t-as="string_line">
                              <div class="one-lines"> ● <span
                                  t-esc="string_line.display_name" />
                                                    <br />
                              </div>
                            </t>
                          </div>
                        </td>
                        <td class="text-center">
                          <div id="quote_qty" class="six-lines">
                            <span t-esc="line.mrp_product_product_qty" />
                          </div>
                        </td>
                        <td class="text-center size14">
                          <div class="six-lines">
                            <t t-if="line.product_id.product_tmpl_id.uom_id.name">
                              <span
                                t-field="line.product_id.product_tmpl_id.uom_id.name" />
                            </t>
                          </div>
                        </td>
                        <td class="text-center size14">
                          <t t-if="line.mrp_production_order_line.instruction_status">
                            有
                          </t>
                        </td>
                        <td class="size13">
                          <div class="six-lines">
                            <t t-if="line.mrp_product_type">
                              <span
                                t-field="line.mrp_product_type" />
                              <br />
                            </t>
                            <t t-foreach="line.order_line" t-as="l">
                              <t t-foreach="l.config_session_id.custom_value_ids"
                                t-as="string_line"> ● <span
                                  t-esc="string_line.display_name" />
                                  <br />
                              </t>
                            </t>
                          </div>
                        </td>
                        <td>
                          <t t-if="line.production_memo">
                            <div class="six-lines">
                              <span t-field="line.production_memo" />
                            </div>
                          </t>
                        </td>
                      </tr>
                    </t>
                  </tbody>
                </t>
              </table>
            </t>
          </div>
          <t t-call="custom_report_rtw.page_footer_layout"></t>
        </t>
      </t>
    </t>
  </template>

  <record id="report_purchase_order_pdf_list_paper" model="report.paperformat">
    <field name="name">Purchase Order Sheet</field>
    <field name="default" eval="False" />
    <field name="format">custom</field>
    <field name="page_width">210</field>
    <field name="page_height">297</field>
    <field name="orientation">Landscape</field>
    <field name="margin_top">20</field>
    <field name="margin_bottom">10</field>
    <field name="margin_left">5</field>
    <field name="margin_right">5</field>
    <field name="header_line" eval="False" />
    <field name="header_spacing">12</field>
    <field name="dpi">90</field>
  </record>

  <record id="report_purchase_order_sheet_rtw" model="ir.actions.report">
    <field name="name">発注書</field>
    <field name="model">mrp.production</field>
    <field name="binding_model_id" ref="model_mrp_production" />
    <field name="report_type">qweb-pdf</field>
    <field name="report_name">custom_report_rtw.report_purchase_order_pdf_list_form</field>
    <field name="report_file">custom_report_rtw.report_purchase_order_pdf_list_form</field>
    <field name="paperformat_id" ref="custom_report_rtw.report_purchase_order_pdf_list_paper" />
    <field name="attachment_use">False</field>
    <field name="binding_view_types">list,form</field>
  </record>

</odoo>